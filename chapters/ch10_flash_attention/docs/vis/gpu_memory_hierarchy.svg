<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 550">
  <!-- Pure black background -->
  <rect width="800" height="550" fill="#000000"/>

  <!-- Title -->
  <text x="400" y="35" font-family="CMU Serif, Georgia, serif" font-size="24" fill="#ffffff" text-anchor="middle">GPU Memory Hierarchy</text>

  <!-- Subtitle -->
  <text x="400" y="60" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#888888" text-anchor="middle">
    Speed vs Capacity Trade-off: Faster memory is smaller
  </text>

  <!-- ============ Memory Pyramid ============ -->
  <g transform="translate(100, 90)">
    <!-- Registers - Top (smallest, fastest) -->
    <polygon points="200,0 260,60 140,60" fill="#FF6B6B" fill-opacity="0.3" stroke="#FF6B6B" stroke-width="2"/>
    <text x="200" y="40" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#FF6B6B" text-anchor="middle">Registers</text>

    <!-- Shared Memory / SRAM -->
    <polygon points="140,65 260,65 290,125 110,125" fill="#FFFF00" fill-opacity="0.3" stroke="#FFFF00" stroke-width="2"/>
    <text x="200" y="100" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#FFFF00" text-anchor="middle">Shared Memory (SRAM)</text>

    <!-- L2 Cache -->
    <polygon points="110,130 290,130 320,190 80,190" fill="#83C167" fill-opacity="0.3" stroke="#83C167" stroke-width="2"/>
    <text x="200" y="165" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#83C167" text-anchor="middle">L2 Cache</text>

    <!-- HBM (largest, slowest) -->
    <polygon points="80,195 320,195 360,270 40,270" fill="#29ABCA" fill-opacity="0.3" stroke="#29ABCA" stroke-width="2"/>
    <text x="200" y="240" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#29ABCA" text-anchor="middle">HBM (Global Memory)</text>

    <!-- Speed Arrow -->
    <g transform="translate(-30, 135)">
      <line x1="0" y1="135" x2="0" y2="0" stroke="#888888" stroke-width="2"/>
      <polygon points="0,0 -5,10 5,10" fill="#888888"/>
      <text x="-15" y="70" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888" text-anchor="middle" transform="rotate(-90, -15, 70)">Faster</text>
    </g>

    <!-- Size Arrow -->
    <g transform="translate(430, 135)">
      <line x1="0" y1="0" x2="0" y2="135" stroke="#888888" stroke-width="2"/>
      <polygon points="0,135 -5,125 5,125" fill="#888888"/>
      <text x="15" y="70" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888" text-anchor="middle" transform="rotate(90, 15, 70)">Larger</text>
    </g>
  </g>

  <!-- ============ Stats Table ============ -->
  <g transform="translate(480, 100)">
    <text x="130" y="0" font-family="CMU Serif, Georgia, serif" font-size="16" fill="#ffffff" text-anchor="middle">A100 GPU Specs</text>

    <!-- Table Headers -->
    <text x="0" y="35" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888">Memory</text>
    <text x="100" y="35" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888">Size</text>
    <text x="170" y="35" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888">Bandwidth</text>

    <!-- Divider -->
    <line x1="0" y1="45" x2="260" y2="45" stroke="#444444" stroke-width="1"/>

    <!-- Registers -->
    <text x="0" y="65" font-family="monospace" font-size="11" fill="#FF6B6B">Registers</text>
    <text x="100" y="65" font-family="monospace" font-size="11" fill="#FF6B6B">~256KB/SM</text>
    <text x="170" y="65" font-family="monospace" font-size="11" fill="#FF6B6B">∞ (1 cycle)</text>

    <!-- SRAM -->
    <text x="0" y="90" font-family="monospace" font-size="11" fill="#FFFF00">SRAM</text>
    <text x="100" y="90" font-family="monospace" font-size="11" fill="#FFFF00">~164KB/SM</text>
    <text x="170" y="90" font-family="monospace" font-size="11" fill="#FFFF00">~19 TB/s</text>

    <!-- L2 -->
    <text x="0" y="115" font-family="monospace" font-size="11" fill="#83C167">L2 Cache</text>
    <text x="100" y="115" font-family="monospace" font-size="11" fill="#83C167">40 MB</text>
    <text x="170" y="115" font-family="monospace" font-size="11" fill="#83C167">~5 TB/s</text>

    <!-- HBM -->
    <text x="0" y="140" font-family="monospace" font-size="11" fill="#29ABCA">HBM</text>
    <text x="100" y="140" font-family="monospace" font-size="11" fill="#29ABCA">40-80 GB</text>
    <text x="170" y="140" font-family="monospace" font-size="11" fill="#29ABCA">2 TB/s</text>

    <!-- Key insight box -->
    <rect x="-10" y="160" width="280" height="50" fill="#FFFF00" fill-opacity="0.1" stroke="#FFFF00" stroke-width="1" rx="5"/>
    <text x="130" y="182" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#FFFF00" text-anchor="middle">Key Insight:</text>
    <text x="130" y="200" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#FFFF00" text-anchor="middle">SRAM is ~10× faster than HBM!</text>
  </g>

  <!-- ============ Standard vs Flash Attention Comparison ============ -->
  <g transform="translate(50, 390)">
    <text x="350" y="0" font-family="CMU Serif, Georgia, serif" font-size="18" fill="#ffffff" text-anchor="middle">Memory Access Pattern</text>

    <!-- Standard Attention -->
    <g transform="translate(0, 30)">
      <text x="150" y="0" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#FF6B6B" text-anchor="middle">Standard Attention</text>

      <!-- HBM boxes -->
      <rect x="20" y="15" width="60" height="30" fill="#29ABCA" fill-opacity="0.3" stroke="#29ABCA" stroke-width="1"/>
      <text x="50" y="35" font-family="monospace" font-size="10" fill="#29ABCA" text-anchor="middle">HBM</text>

      <rect x="120" y="15" width="60" height="30" fill="#29ABCA" fill-opacity="0.3" stroke="#29ABCA" stroke-width="1"/>
      <text x="150" y="35" font-family="monospace" font-size="10" fill="#29ABCA" text-anchor="middle">HBM</text>

      <rect x="220" y="15" width="60" height="30" fill="#29ABCA" fill-opacity="0.3" stroke="#29ABCA" stroke-width="1"/>
      <text x="250" y="35" font-family="monospace" font-size="10" fill="#29ABCA" text-anchor="middle">HBM</text>

      <!-- Arrows showing many round trips -->
      <path d="M80,30 Q100,60 120,30" fill="none" stroke="#FF6B6B" stroke-width="1.5" marker-end="url(#arrowRed)"/>
      <path d="M180,30 Q200,60 220,30" fill="none" stroke="#FF6B6B" stroke-width="1.5" marker-end="url(#arrowRed)"/>

      <!-- Labels -->
      <text x="50" y="70" font-family="monospace" font-size="9" fill="#888888" text-anchor="middle">QK^T</text>
      <text x="150" y="70" font-family="monospace" font-size="9" fill="#888888" text-anchor="middle">softmax</text>
      <text x="250" y="70" font-family="monospace" font-size="9" fill="#888888" text-anchor="middle">×V</text>

      <text x="150" y="95" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#FF6B6B" text-anchor="middle">Many HBM round trips!</text>
    </g>

    <!-- Flash Attention -->
    <g transform="translate(380, 30)">
      <text x="150" y="0" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#83C167" text-anchor="middle">Flash Attention</text>

      <!-- HBM to SRAM -->
      <rect x="20" y="15" width="60" height="30" fill="#29ABCA" fill-opacity="0.3" stroke="#29ABCA" stroke-width="1"/>
      <text x="50" y="35" font-family="monospace" font-size="10" fill="#29ABCA" text-anchor="middle">HBM</text>

      <!-- SRAM processing -->
      <rect x="110" y="10" width="100" height="40" fill="#FFFF00" fill-opacity="0.2" stroke="#FFFF00" stroke-width="2"/>
      <text x="160" y="27" font-family="monospace" font-size="9" fill="#FFFF00" text-anchor="middle">SRAM</text>
      <text x="160" y="42" font-family="monospace" font-size="8" fill="#FFFF00" text-anchor="middle">(all ops here)</text>

      <!-- HBM output -->
      <rect x="240" y="15" width="60" height="30" fill="#29ABCA" fill-opacity="0.3" stroke="#29ABCA" stroke-width="1"/>
      <text x="270" y="35" font-family="monospace" font-size="10" fill="#29ABCA" text-anchor="middle">HBM</text>

      <!-- Arrows -->
      <line x1="80" y1="30" x2="108" y2="30" stroke="#83C167" stroke-width="1.5"/>
      <polygon points="108,30 102,27 102,33" fill="#83C167"/>
      <line x1="212" y1="30" x2="238" y2="30" stroke="#83C167" stroke-width="1.5"/>
      <polygon points="238,30 232,27 232,33" fill="#83C167"/>

      <!-- Labels -->
      <text x="95" y="55" font-family="monospace" font-size="9" fill="#888888" text-anchor="middle">load</text>
      <text x="225" y="55" font-family="monospace" font-size="9" fill="#888888" text-anchor="middle">store</text>

      <text x="160" y="95" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#83C167" text-anchor="middle">Minimal HBM traffic!</text>
    </g>
  </g>

  <!-- Arrow markers -->
  <defs>
    <marker id="arrowRed" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto">
      <polygon points="0,0 6,3 0,6" fill="#FF6B6B"/>
    </marker>
  </defs>
</svg>
