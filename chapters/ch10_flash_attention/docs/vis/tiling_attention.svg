<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500">
  <!-- Pure black background -->
  <rect width="800" height="500" fill="#000000"/>

  <!-- Title -->
  <text x="400" y="35" font-family="CMU Serif, Georgia, serif" font-size="24" fill="#ffffff" text-anchor="middle">Tiling: Computing Attention in Blocks</text>

  <!-- Subtitle -->
  <text x="400" y="60" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#888888" text-anchor="middle">
    The N×N attention matrix doesn't fit in SRAM — compute it block by block
  </text>

  <!-- ============ Full Matrix (Problem) ============ -->
  <g transform="translate(50, 90)">
    <text x="100" y="0" font-family="CMU Serif, Georgia, serif" font-size="16" fill="#FF6B6B" text-anchor="middle">Full Attention Matrix</text>

    <!-- Large matrix outline -->
    <rect x="0" y="15" width="200" height="200" fill="#FF6B6B" fill-opacity="0.1" stroke="#FF6B6B" stroke-width="2"/>

    <!-- N x N label -->
    <text x="100" y="120" font-family="CMU Serif, Georgia, serif" font-size="18" fill="#FF6B6B" text-anchor="middle">N × N</text>

    <!-- Size note -->
    <text x="100" y="235" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888" text-anchor="middle">N = 4096 → 64 MB</text>
    <text x="100" y="252" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#FF6B6B" text-anchor="middle">Too big for SRAM!</text>

    <!-- Axis labels -->
    <text x="100" y="280" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#666666" text-anchor="middle">Keys (K)</text>
    <text x="-15" y="115" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#666666" text-anchor="middle" transform="rotate(-90, -15, 115)">Queries (Q)</text>
  </g>

  <!-- Arrow -->
  <g transform="translate(280, 190)">
    <line x1="0" y1="0" x2="50" y2="0" stroke="#888888" stroke-width="2"/>
    <polygon points="50,0 43,-5 43,5" fill="#888888"/>
    <text x="25" y="-10" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#FFFF00" text-anchor="middle">Tile it!</text>
  </g>

  <!-- ============ Tiled Matrix (Solution) ============ -->
  <g transform="translate(360, 90)">
    <text x="100" y="0" font-family="CMU Serif, Georgia, serif" font-size="16" fill="#83C167" text-anchor="middle">Tiled Attention</text>

    <!-- Grid of blocks -->
    <g transform="translate(0, 15)">
      <!-- Row 0 -->
      <rect x="0" y="0" width="50" height="50" fill="#83C167" fill-opacity="0.3" stroke="#83C167" stroke-width="2"/>
      <text x="25" y="30" font-family="monospace" font-size="10" fill="#83C167" text-anchor="middle">B₀₀</text>
      <rect x="50" y="0" width="50" height="50" fill="#83C167" fill-opacity="0.1" stroke="#444444" stroke-width="1"/>
      <text x="75" y="30" font-family="monospace" font-size="10" fill="#666666" text-anchor="middle">B₀₁</text>
      <rect x="100" y="0" width="50" height="50" fill="#83C167" fill-opacity="0.1" stroke="#444444" stroke-width="1"/>
      <text x="125" y="30" font-family="monospace" font-size="10" fill="#666666" text-anchor="middle">B₀₂</text>
      <rect x="150" y="0" width="50" height="50" fill="#83C167" fill-opacity="0.1" stroke="#444444" stroke-width="1"/>
      <text x="175" y="30" font-family="monospace" font-size="10" fill="#666666" text-anchor="middle">B₀₃</text>

      <!-- Row 1 -->
      <rect x="0" y="50" width="50" height="50" fill="#83C167" fill-opacity="0.1" stroke="#444444" stroke-width="1"/>
      <rect x="50" y="50" width="50" height="50" fill="#83C167" fill-opacity="0.1" stroke="#444444" stroke-width="1"/>
      <rect x="100" y="50" width="50" height="50" fill="#83C167" fill-opacity="0.1" stroke="#444444" stroke-width="1"/>
      <rect x="150" y="50" width="50" height="50" fill="#83C167" fill-opacity="0.1" stroke="#444444" stroke-width="1"/>

      <!-- Row 2 -->
      <rect x="0" y="100" width="50" height="50" fill="#83C167" fill-opacity="0.1" stroke="#444444" stroke-width="1"/>
      <rect x="50" y="100" width="50" height="50" fill="#83C167" fill-opacity="0.1" stroke="#444444" stroke-width="1"/>
      <rect x="100" y="100" width="50" height="50" fill="#83C167" fill-opacity="0.1" stroke="#444444" stroke-width="1"/>
      <rect x="150" y="100" width="50" height="50" fill="#83C167" fill-opacity="0.1" stroke="#444444" stroke-width="1"/>

      <!-- Row 3 -->
      <rect x="0" y="150" width="50" height="50" fill="#83C167" fill-opacity="0.1" stroke="#444444" stroke-width="1"/>
      <rect x="50" y="150" width="50" height="50" fill="#83C167" fill-opacity="0.1" stroke="#444444" stroke-width="1"/>
      <rect x="100" y="150" width="50" height="50" fill="#83C167" fill-opacity="0.1" stroke="#444444" stroke-width="1"/>
      <rect x="150" y="150" width="50" height="50" fill="#83C167" fill-opacity="0.1" stroke="#444444" stroke-width="1"/>
    </g>

    <!-- Block size annotation -->
    <g transform="translate(210, 15)">
      <line x1="0" y1="0" x2="0" y2="50" stroke="#FFFF00" stroke-width="1"/>
      <line x1="-5" y1="0" x2="5" y2="0" stroke="#FFFF00" stroke-width="1"/>
      <line x1="-5" y1="50" x2="5" y2="50" stroke="#FFFF00" stroke-width="1"/>
      <text x="15" y="30" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#FFFF00">B_r</text>
    </g>

    <g transform="translate(0, 225)">
      <line x1="0" y1="0" x2="50" y2="0" stroke="#FFFF00" stroke-width="1"/>
      <line x1="0" y1="-5" x2="0" y2="5" stroke="#FFFF00" stroke-width="1"/>
      <line x1="50" y1="-5" x2="50" y2="5" stroke="#FFFF00" stroke-width="1"/>
      <text x="25" y="15" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#FFFF00" text-anchor="middle">B_c</text>
    </g>

    <text x="100" y="260" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#83C167" text-anchor="middle">Each block fits in SRAM!</text>
  </g>

  <!-- ============ Block Processing Diagram ============ -->
  <g transform="translate(600, 100)">
    <text x="85" y="0" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#FFFF00" text-anchor="middle">Processing One Block</text>

    <!-- SRAM box -->
    <rect x="10" y="20" width="150" height="130" fill="#FFFF00" fill-opacity="0.1" stroke="#FFFF00" stroke-width="2" rx="5"/>
    <text x="85" y="40" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#FFFF00" text-anchor="middle">In SRAM:</text>

    <!-- Contents -->
    <text x="30" y="65" font-family="monospace" font-size="10" fill="#29ABCA">Q block: B_r × d</text>
    <text x="30" y="85" font-family="monospace" font-size="10" fill="#29ABCA">K block: B_c × d</text>
    <text x="30" y="105" font-family="monospace" font-size="10" fill="#29ABCA">V block: B_c × d</text>
    <text x="30" y="125" font-family="monospace" font-size="10" fill="#83C167">Scores: B_r × B_c</text>
    <text x="30" y="145" font-family="monospace" font-size="10" fill="#FF6B6B">Output: B_r × d</text>
  </g>

  <!-- ============ Causal Masking ============ -->
  <g transform="translate(50, 340)">
    <text x="350" y="0" font-family="CMU Serif, Georgia, serif" font-size="18" fill="#ffffff" text-anchor="middle">Causal Masking Optimization</text>

    <!-- Causal matrix -->
    <g transform="translate(100, 30)">
      <text x="75" y="-10" font-family="CMU Serif, Georgia, serif" font-size="13" fill="#888888" text-anchor="middle">Causal Mask</text>

      <!-- Row 0 -->
      <rect x="0" y="0" width="37" height="37" fill="#83C167" fill-opacity="0.4" stroke="#83C167" stroke-width="1"/>
      <rect x="37" y="0" width="37" height="37" fill="none" stroke="#444444" stroke-width="1"/>
      <rect x="74" y="0" width="37" height="37" fill="none" stroke="#444444" stroke-width="1"/>
      <rect x="111" y="0" width="37" height="37" fill="none" stroke="#444444" stroke-width="1"/>

      <!-- Row 1 -->
      <rect x="0" y="37" width="37" height="37" fill="#83C167" fill-opacity="0.4" stroke="#83C167" stroke-width="1"/>
      <rect x="37" y="37" width="37" height="37" fill="#83C167" fill-opacity="0.4" stroke="#83C167" stroke-width="1"/>
      <rect x="74" y="37" width="37" height="37" fill="none" stroke="#444444" stroke-width="1"/>
      <rect x="111" y="37" width="37" height="37" fill="none" stroke="#444444" stroke-width="1"/>

      <!-- Row 2 -->
      <rect x="0" y="74" width="37" height="37" fill="#83C167" fill-opacity="0.4" stroke="#83C167" stroke-width="1"/>
      <rect x="37" y="74" width="37" height="37" fill="#83C167" fill-opacity="0.4" stroke="#83C167" stroke-width="1"/>
      <rect x="74" y="74" width="37" height="37" fill="#83C167" fill-opacity="0.4" stroke="#83C167" stroke-width="1"/>
      <rect x="111" y="74" width="37" height="37" fill="none" stroke="#444444" stroke-width="1"/>

      <!-- Row 3 -->
      <rect x="0" y="111" width="37" height="37" fill="#83C167" fill-opacity="0.4" stroke="#83C167" stroke-width="1"/>
      <rect x="37" y="111" width="37" height="37" fill="#83C167" fill-opacity="0.4" stroke="#83C167" stroke-width="1"/>
      <rect x="74" y="111" width="37" height="37" fill="#83C167" fill-opacity="0.4" stroke="#83C167" stroke-width="1"/>
      <rect x="111" y="111" width="37" height="37" fill="#83C167" fill-opacity="0.4" stroke="#83C167" stroke-width="1"/>
    </g>

    <!-- Legend -->
    <g transform="translate(320, 50)">
      <rect x="0" y="0" width="20" height="15" fill="#83C167" fill-opacity="0.4" stroke="#83C167" stroke-width="1"/>
      <text x="30" y="12" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#83C167">Compute this block</text>

      <rect x="0" y="25" width="20" height="15" fill="none" stroke="#444444" stroke-width="1"/>
      <text x="30" y="37" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#888888">Skip entirely!</text>
    </g>

    <!-- Savings note -->
    <g transform="translate(320, 110)">
      <rect x="-10" y="-5" width="220" height="35" fill="#FFFF00" fill-opacity="0.1" stroke="#FFFF00" stroke-width="1" rx="3"/>
      <text x="100" y="12" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#FFFF00" text-anchor="middle">Upper triangle blocks are skipped</text>
      <text x="100" y="27" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#FFFF00" text-anchor="middle">→ ~50% compute savings!</text>
    </g>
  </g>
</svg>
