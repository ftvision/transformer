<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 520">
  <!-- Background -->
  <rect width="900" height="520" fill="#000000"/>

  <!-- Title -->
  <text x="450" y="35" font-family="CMU Serif, Georgia, serif" font-size="24" fill="#ffffff" text-anchor="middle">Feed-Forward Network Architecture</text>

  <!-- Subtitle -->
  <text x="450" y="60" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#888888" text-anchor="middle">
    Expand → Activate → Contract pattern
  </text>

  <!-- ============ Standard FFN (left) ============ -->
  <g transform="translate(150, 100)">
    <text x="100" y="0" font-family="CMU Serif, Georgia, serif" font-size="16" fill="#29ABCA" text-anchor="middle">Standard FFN</text>
    <text x="100" y="18" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#666666" text-anchor="middle">GPT-2, BERT</text>

    <!-- Input -->
    <rect x="50" y="40" width="100" height="35" fill="none" stroke="#29ABCA" stroke-width="2"/>
    <text x="100" y="63" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#29ABCA" text-anchor="middle">d_model</text>

    <!-- Arrow + W1 -->
    <line x1="100" y1="75" x2="100" y2="105" stroke="#666666" stroke-width="2"/>
    <polygon points="100,110 95,102 105,102" fill="#666666"/>
    <text x="120" y="95" font-family="monospace" font-size="10" fill="#888888" text-anchor="start">W1</text>

    <!-- Expanded hidden -->
    <rect x="20" y="115" width="160" height="45" fill="#FC6255" fill-opacity="0.2" stroke="#FC6255" stroke-width="2"/>
    <text x="100" y="135" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#FC6255" text-anchor="middle">d_ff = 4 × d_model</text>
    <text x="100" y="152" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#888888" text-anchor="middle">(expanded)</text>

    <!-- Arrow + activation -->
    <line x1="100" y1="160" x2="100" y2="185" stroke="#666666" stroke-width="2"/>
    <polygon points="100,190 95,182 105,182" fill="#666666"/>
    <text x="120" y="178" font-family="monospace" font-size="10" fill="#FFFF00" text-anchor="start">GELU</text>

    <!-- After activation -->
    <rect x="20" y="195" width="160" height="35" fill="#FFFF00" fill-opacity="0.1" stroke="#FFFF00" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="100" y="218" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#FFFF00" text-anchor="middle">activated</text>

    <!-- Arrow + W2 -->
    <line x1="100" y1="230" x2="100" y2="260" stroke="#666666" stroke-width="2"/>
    <polygon points="100,265 95,257 105,257" fill="#666666"/>
    <text x="120" y="248" font-family="monospace" font-size="10" fill="#888888" text-anchor="start">W2</text>

    <!-- Output -->
    <rect x="50" y="270" width="100" height="35" fill="none" stroke="#83C167" stroke-width="2"/>
    <text x="100" y="293" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#83C167" text-anchor="middle">d_model</text>

    <!-- Parameter count -->
    <text x="100" y="330" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#888888" text-anchor="middle">Params: 8d²</text>
  </g>

  <!-- ============ SwiGLU FFN (right) ============ -->
  <g transform="translate(550, 100)">
    <text x="120" y="0" font-family="CMU Serif, Georgia, serif" font-size="16" fill="#83C167" text-anchor="middle">SwiGLU FFN</text>
    <text x="120" y="18" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#666666" text-anchor="middle">LLaMA, Mistral</text>

    <!-- Input -->
    <rect x="70" y="40" width="100" height="35" fill="none" stroke="#29ABCA" stroke-width="2"/>
    <text x="120" y="63" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#29ABCA" text-anchor="middle">d_model</text>

    <!-- Split into two paths -->
    <circle cx="120" cy="90" r="3" fill="#29ABCA"/>
    <line x1="120" y1="75" x2="120" y2="87" stroke="#666666" stroke-width="2"/>

    <!-- Left path (gate) -->
    <line x1="117" y1="90" x2="60" y2="90" stroke="#666666" stroke-width="2"/>
    <line x1="60" y1="90" x2="60" y2="115" stroke="#666666" stroke-width="2"/>
    <polygon points="60,120 55,112 65,112" fill="#666666"/>
    <text x="30" y="105" font-family="monospace" font-size="10" fill="#888888" text-anchor="start">W1</text>

    <!-- Right path (value) -->
    <line x1="123" y1="90" x2="180" y2="90" stroke="#666666" stroke-width="2"/>
    <line x1="180" y1="90" x2="180" y2="115" stroke="#666666" stroke-width="2"/>
    <polygon points="180,120 175,112 185,112" fill="#666666"/>
    <text x="195" y="105" font-family="monospace" font-size="10" fill="#888888" text-anchor="start">W2</text>

    <!-- Gate box -->
    <rect x="10" y="125" width="100" height="40" fill="#FC6255" fill-opacity="0.2" stroke="#FC6255" stroke-width="2"/>
    <text x="60" y="142" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#FC6255" text-anchor="middle">d_ff = 2.67d</text>
    <text x="60" y="157" font-family="monospace" font-size="9" fill="#FFFF00" text-anchor="middle">SiLU(·)</text>

    <!-- Value box -->
    <rect x="130" y="125" width="100" height="40" fill="#29ABCA" fill-opacity="0.2" stroke="#29ABCA" stroke-width="2"/>
    <text x="180" y="142" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#29ABCA" text-anchor="middle">d_ff = 2.67d</text>
    <text x="180" y="157" font-family="CMU Serif, Georgia, serif" font-size="9" fill="#888888" text-anchor="middle">(linear)</text>

    <!-- Arrows to multiply -->
    <line x1="60" y1="165" x2="60" y2="195" stroke="#666666" stroke-width="2"/>
    <line x1="180" y1="165" x2="180" y2="195" stroke="#666666" stroke-width="2"/>
    <line x1="60" y1="200" x2="105" y2="200" stroke="#666666" stroke-width="2"/>
    <line x1="180" y1="200" x2="135" y2="200" stroke="#666666" stroke-width="2"/>

    <!-- Multiply circle -->
    <circle cx="120" cy="200" r="12" fill="none" stroke="#FFFF00" stroke-width="2"/>
    <text x="120" y="204" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#FFFF00" text-anchor="middle">×</text>

    <!-- Arrow to W3 -->
    <line x1="120" y1="212" x2="120" y2="240" stroke="#666666" stroke-width="2"/>
    <polygon points="120,245 115,237 125,237" fill="#666666"/>
    <text x="140" y="232" font-family="monospace" font-size="10" fill="#888888" text-anchor="start">W3</text>

    <!-- Output -->
    <rect x="70" y="250" width="100" height="35" fill="none" stroke="#83C167" stroke-width="2"/>
    <text x="120" y="273" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#83C167" text-anchor="middle">d_model</text>

    <!-- Parameter count -->
    <text x="120" y="310" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#888888" text-anchor="middle">Params: 8d² (matched)</text>
  </g>

  <!-- Bottom comparison box -->
  <g transform="translate(80, 420)">
    <rect x="0" y="0" width="740" height="85" fill="none" stroke="#444444" stroke-width="1"/>
    <text x="370" y="22" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#FFFF00" text-anchor="middle">Key Difference: Gating</text>

    <text x="20" y="50" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888" text-anchor="start">Standard:</text>
    <text x="90" y="50" font-family="monospace" font-size="12" fill="#29ABCA" text-anchor="start">output = W2(activation(W1(x)))</text>

    <text x="400" y="50" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888" text-anchor="start">SwiGLU:</text>
    <text x="465" y="50" font-family="monospace" font-size="12" fill="#83C167" text-anchor="start">output = W3(SiLU(W1(x)) × W2(x))</text>

    <text x="370" y="75" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#888888" text-anchor="middle">Gate path can selectively block/pass information from value path</text>
  </g>
</svg>
