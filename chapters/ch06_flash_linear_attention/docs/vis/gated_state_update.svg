<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 500">
  <!-- Pure black background -->
  <rect width="900" height="500" fill="#000000"/>

  <!-- Title -->
  <text x="450" y="35" font-family="CMU Serif, Georgia, serif" font-size="24" fill="#ffffff" text-anchor="middle">Gated Linear Attention</text>

  <!-- Subtitle -->
  <text x="450" y="60" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#888888" text-anchor="middle">
    Data-dependent gates control what to remember and forget
  </text>

  <!-- ============ Vanilla Linear Attention ============ -->
  <g transform="translate(50, 100)">
    <text x="175" y="0" font-family="CMU Serif, Georgia, serif" font-size="16" fill="#29ABCA" text-anchor="middle">Vanilla Linear Attention</text>

    <!-- State boxes -->
    <g transform="translate(0, 30)">
      <!-- S_{t-1} -->
      <rect x="0" y="0" width="80" height="60" fill="#29ABCA" fill-opacity="0.2" stroke="#29ABCA" stroke-width="2"/>
      <text x="40" y="35" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#29ABCA" text-anchor="middle">S
        <tspan font-size="10" dy="3">t-1</tspan>
      </text>

      <!-- Plus -->
      <text x="105" y="35" font-family="CMU Serif, Georgia, serif" font-size="20" fill="#ffffff" text-anchor="middle">+</text>

      <!-- kv outer product -->
      <rect x="130" y="0" width="80" height="60" fill="#FFFF00" fill-opacity="0.2" stroke="#FFFF00" stroke-width="2"/>
      <text x="170" y="30" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#FFFF00" text-anchor="middle">k
        <tspan font-size="8" dy="2">t</tspan>
        <tspan dy="-2" baseline-shift="super" font-size="8">T</tspan>
        <tspan> v</tspan>
        <tspan font-size="8" dy="2">t</tspan>
      </text>
      <text x="170" y="50" font-family="CMU Serif, Georgia, serif" font-size="9" fill="#888888" text-anchor="middle">new memory</text>

      <!-- Arrow -->
      <line x1="225" y1="30" x2="265" y2="30" stroke="#888888" stroke-width="2"/>
      <polygon points="265,30 258,26 258,34" fill="#888888"/>

      <!-- S_t -->
      <rect x="280" y="0" width="80" height="60" fill="#29ABCA" fill-opacity="0.2" stroke="#29ABCA" stroke-width="2"/>
      <text x="320" y="35" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#29ABCA" text-anchor="middle">S
        <tspan font-size="10" dy="3">t</tspan>
      </text>
    </g>

    <!-- Problem annotation -->
    <g transform="translate(0, 120)">
      <text x="175" y="0" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#FF6B6B" text-anchor="middle">Problem: No forgetting!</text>
      <text x="175" y="18" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#888888" text-anchor="middle">State grows forever</text>
    </g>
  </g>

  <!-- ============ Gated Linear Attention ============ -->
  <g transform="translate(480, 100)">
    <text x="190" y="0" font-family="CMU Serif, Georgia, serif" font-size="16" fill="#83C167" text-anchor="middle">Gated Linear Attention</text>

    <!-- State boxes with gating -->
    <g transform="translate(0, 30)">
      <!-- g * S_{t-1} -->
      <g>
        <rect x="0" y="0" width="100" height="60" fill="#83C167" fill-opacity="0.2" stroke="#83C167" stroke-width="2"/>
        <text x="50" y="25" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#83C167" text-anchor="middle">g
          <tspan font-size="9" dy="2">t</tspan>
          <tspan dy="-2"> · S</tspan>
          <tspan font-size="9" dy="2">t-1</tspan>
        </text>
        <text x="50" y="45" font-family="CMU Serif, Georgia, serif" font-size="9" fill="#666666" text-anchor="middle">retained</text>
      </g>

      <!-- Plus -->
      <text x="120" y="35" font-family="CMU Serif, Georgia, serif" font-size="20" fill="#ffffff" text-anchor="middle">+</text>

      <!-- (1-g) * kv -->
      <g transform="translate(140, 0)">
        <rect x="0" y="0" width="100" height="60" fill="#FFFF00" fill-opacity="0.2" stroke="#FFFF00" stroke-width="2"/>
        <text x="50" y="25" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#FFFF00" text-anchor="middle">(1-g
          <tspan font-size="8" dy="2">t</tspan>
          <tspan dy="-2">) · k</tspan>
          <tspan font-size="8" dy="2">t</tspan>
          <tspan dy="-2" baseline-shift="super" font-size="8">T</tspan>
          <tspan>v</tspan>
          <tspan font-size="8" dy="2">t</tspan>
        </text>
        <text x="50" y="45" font-family="CMU Serif, Georgia, serif" font-size="9" fill="#666666" text-anchor="middle">written</text>
      </g>

      <!-- Arrow -->
      <line x1="255" y1="30" x2="295" y2="30" stroke="#888888" stroke-width="2"/>
      <polygon points="295,30 288,26 288,34" fill="#888888"/>

      <!-- S_t -->
      <rect x="310" y="0" width="80" height="60" fill="#83C167" fill-opacity="0.2" stroke="#83C167" stroke-width="2"/>
      <text x="350" y="35" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#83C167" text-anchor="middle">S
        <tspan font-size="10" dy="3">t</tspan>
      </text>
    </g>

    <!-- Benefit annotation -->
    <g transform="translate(0, 120)">
      <text x="190" y="0" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#83C167" text-anchor="middle">Data-dependent forgetting!</text>
      <text x="190" y="18" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#888888" text-anchor="middle">Model learns what to keep</text>
    </g>
  </g>

  <!-- ============ Gate Behavior ============ -->
  <g transform="translate(100, 280)">
    <text x="350" y="0" font-family="CMU Serif, Georgia, serif" font-size="16" fill="#ffffff" text-anchor="middle">Gate Behavior</text>

    <!-- Gate = 1 -->
    <g transform="translate(0, 30)">
      <rect x="0" y="0" width="200" height="70" fill="#83C167" fill-opacity="0.1" stroke="#83C167" rx="5"/>
      <text x="100" y="25" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#83C167" text-anchor="middle">g → 1</text>
      <text x="100" y="45" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888" text-anchor="middle">Keep previous state</text>
      <text x="100" y="60" font-family="monospace" font-size="10" fill="#666666" text-anchor="middle">S_t ≈ S_{t-1}</text>
    </g>

    <!-- Gate = 0.5 -->
    <g transform="translate(250, 30)">
      <rect x="0" y="0" width="200" height="70" fill="#FFFF00" fill-opacity="0.1" stroke="#FFFF00" rx="5"/>
      <text x="100" y="25" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#FFFF00" text-anchor="middle">g ≈ 0.5</text>
      <text x="100" y="45" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888" text-anchor="middle">Blend old and new</text>
      <text x="100" y="60" font-family="monospace" font-size="10" fill="#666666" text-anchor="middle">interpolation</text>
    </g>

    <!-- Gate = 0 -->
    <g transform="translate(500, 30)">
      <rect x="0" y="0" width="200" height="70" fill="#FF6B6B" fill-opacity="0.1" stroke="#FF6B6B" rx="5"/>
      <text x="100" y="25" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#FF6B6B" text-anchor="middle">g → 0</text>
      <text x="100" y="45" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888" text-anchor="middle">Forget and overwrite</text>
      <text x="100" y="60" font-family="monospace" font-size="10" fill="#666666" text-anchor="middle">S_t ≈ k_t^T v_t</text>
    </g>
  </g>

  <!-- ============ Architecture Flow ============ -->
  <g transform="translate(100, 400)">
    <text x="350" y="0" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#888888" text-anchor="middle">Gate is computed from input: g = σ(W_g · x + b)</text>

    <!-- Flow diagram -->
    <g transform="translate(100, 20)">
      <rect x="0" y="0" width="60" height="30" fill="#29ABCA" fill-opacity="0.2" stroke="#29ABCA" rx="3"/>
      <text x="30" y="20" font-family="monospace" font-size="11" fill="#29ABCA" text-anchor="middle">x_t</text>

      <line x1="65" y1="15" x2="95" y2="15" stroke="#888888" stroke-width="1"/>
      <polygon points="95,15 90,12 90,18" fill="#888888"/>

      <rect x="100" y="0" width="80" height="30" fill="#FFFF00" fill-opacity="0.2" stroke="#FFFF00" rx="3"/>
      <text x="140" y="20" font-family="monospace" font-size="11" fill="#FFFF00" text-anchor="middle">σ(W_g·x)</text>

      <line x1="185" y1="15" x2="215" y2="15" stroke="#888888" stroke-width="1"/>
      <polygon points="215,15 210,12 210,18" fill="#888888"/>

      <rect x="220" y="0" width="60" height="30" fill="#83C167" fill-opacity="0.2" stroke="#83C167" rx="3"/>
      <text x="250" y="20" font-family="monospace" font-size="11" fill="#83C167" text-anchor="middle">g_t</text>

      <text x="320" y="20" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#888888" text-anchor="middle">∈ (0, 1)</text>
    </g>
  </g>
</svg>