<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500">
  <!-- Pure black background -->
  <rect width="800" height="500" fill="#000000"/>

  <!-- Title -->
  <text x="400" y="35" font-family="CMU Serif, Georgia, serif" font-size="24" fill="#ffffff" text-anchor="middle">Cross-Entropy Loss for Language Models</text>

  <!-- Subtitle -->
  <text x="400" y="60" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#888888" text-anchor="middle">
    Loss = -log(P(correct token)) — penalize low confidence in the right answer
  </text>

  <!-- ============ Left side: Logits to Softmax ============ -->
  <g transform="translate(50, 100)">
    <text x="80" y="-15" font-family="CMU Serif, Georgia, serif" font-size="16" fill="#888888" text-anchor="middle">Model Output (Logits)</text>

    <!-- Logits vector -->
    <g transform="translate(20, 10)">
      <rect x="0" y="0" width="120" height="35" fill="none" stroke="#444444" stroke-width="1"/>
      <text x="20" y="23" font-family="monospace" font-size="12" fill="#29ABCA" text-anchor="middle">2.0</text>
      <text x="60" y="23" font-family="monospace" font-size="12" fill="#29ABCA" text-anchor="middle">1.0</text>
      <text x="100" y="23" font-family="monospace" font-size="12" fill="#FFFF00" text-anchor="middle">5.0</text>

      <!-- Labels -->
      <text x="20" y="55" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#666666" text-anchor="middle">cat</text>
      <text x="60" y="55" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#666666" text-anchor="middle">dog</text>
      <text x="100" y="55" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#FFFF00" text-anchor="middle">mat</text>
    </g>

    <!-- Target indicator -->
    <text x="140" y="85" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#83C167" text-anchor="middle">↑ target</text>
  </g>

  <!-- Arrow: Logits to Softmax -->
  <g transform="translate(200, 140)">
    <line x1="0" y1="0" x2="60" y2="0" stroke="#888888" stroke-width="2"/>
    <polygon points="60,0 53,-4 53,4" fill="#888888"/>
    <text x="30" y="-10" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#FFFF00" text-anchor="middle">softmax</text>
  </g>

  <!-- ============ Middle: Probabilities ============ -->
  <g transform="translate(280, 100)">
    <text x="80" y="-15" font-family="CMU Serif, Georgia, serif" font-size="16" fill="#FFFF00" text-anchor="middle">Probabilities</text>

    <!-- Probability bars -->
    <g transform="translate(20, 10)">
      <!-- Bar backgrounds -->
      <rect x="0" y="0" width="120" height="35" fill="none" stroke="#444444" stroke-width="1"/>

      <!-- Probability values -->
      <text x="20" y="23" font-family="monospace" font-size="11" fill="#FFFF00" text-anchor="middle">.05</text>
      <text x="60" y="23" font-family="monospace" font-size="11" fill="#FFFF00" text-anchor="middle">.02</text>
      <text x="100" y="23" font-family="monospace" font-size="11" fill="#83C167" text-anchor="middle">.93</text>

      <!-- Labels -->
      <text x="20" y="55" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#666666" text-anchor="middle">cat</text>
      <text x="60" y="55" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#666666" text-anchor="middle">dog</text>
      <text x="100" y="55" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#83C167" text-anchor="middle">mat</text>
    </g>

    <!-- Sum indicator -->
    <text x="155" y="35" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#83C167" text-anchor="start">Σ=1</text>
  </g>

  <!-- Arrow: Probabilities to Loss -->
  <g transform="translate(430, 140)">
    <line x1="0" y1="0" x2="60" y2="0" stroke="#888888" stroke-width="2"/>
    <polygon points="60,0 53,-4 53,4" fill="#888888"/>
    <text x="30" y="-10" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#FF6B6B" text-anchor="middle">-log(p)</text>
  </g>

  <!-- ============ Right: Loss Value ============ -->
  <g transform="translate(520, 100)">
    <text x="100" y="-15" font-family="CMU Serif, Georgia, serif" font-size="16" fill="#FF6B6B" text-anchor="middle">Loss</text>

    <g transform="translate(40, 20)">
      <!-- Loss calculation -->
      <text x="60" y="0" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#888888" text-anchor="middle">-log(0.93)</text>
      <text x="60" y="25" font-family="CMU Serif, Georgia, serif" font-size="20" fill="#83C167" text-anchor="middle">= 0.07</text>
      <text x="60" y="50" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888" text-anchor="middle">(Good prediction!)</text>
    </g>
  </g>

  <!-- ============ Bad Prediction Example ============ -->
  <g transform="translate(50, 240)">
    <text x="350" y="0" font-family="CMU Serif, Georgia, serif" font-size="18" fill="#ffffff" text-anchor="middle">What if the model is wrong?</text>

    <g transform="translate(0, 30)">
      <!-- Logits -->
      <text x="80" y="-5" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#888888" text-anchor="middle">Logits</text>
      <g transform="translate(20, 10)">
        <rect x="0" y="0" width="120" height="35" fill="none" stroke="#444444" stroke-width="1"/>
        <text x="20" y="23" font-family="monospace" font-size="12" fill="#FF6B6B" text-anchor="middle">5.0</text>
        <text x="60" y="23" font-family="monospace" font-size="12" fill="#29ABCA" text-anchor="middle">1.0</text>
        <text x="100" y="23" font-family="monospace" font-size="12" fill="#29ABCA" text-anchor="middle">0.5</text>
        <text x="20" y="55" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#FF6B6B" text-anchor="middle">cat</text>
        <text x="60" y="55" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#666666" text-anchor="middle">dog</text>
        <text x="100" y="55" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#83C167" text-anchor="middle">mat</text>
      </g>
      <text x="80" y="85" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#FF6B6B" text-anchor="middle">Model thinks "cat"</text>
      <text x="140" y="55" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#83C167" text-anchor="start">← target</text>
    </g>

    <!-- Arrow -->
    <g transform="translate(175, 70)">
      <line x1="0" y1="0" x2="50" y2="0" stroke="#888888" stroke-width="2"/>
      <polygon points="50,0 43,-4 43,4" fill="#888888"/>
    </g>

    <!-- Probabilities -->
    <g transform="translate(250, 30)">
      <text x="60" y="-5" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#FFFF00" text-anchor="middle">Probs</text>
      <g transform="translate(0, 10)">
        <rect x="0" y="0" width="120" height="35" fill="none" stroke="#444444" stroke-width="1"/>
        <text x="20" y="23" font-family="monospace" font-size="11" fill="#FF6B6B" text-anchor="middle">.92</text>
        <text x="60" y="23" font-family="monospace" font-size="11" fill="#FFFF00" text-anchor="middle">.05</text>
        <text x="100" y="23" font-family="monospace" font-size="11" fill="#83C167" text-anchor="middle">.03</text>
      </g>
      <text x="100" y="65" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#83C167" text-anchor="middle">↑ only 3%</text>
    </g>

    <!-- Arrow -->
    <g transform="translate(395, 70)">
      <line x1="0" y1="0" x2="50" y2="0" stroke="#888888" stroke-width="2"/>
      <polygon points="50,0 43,-4 43,4" fill="#888888"/>
    </g>

    <!-- Loss -->
    <g transform="translate(470, 30)">
      <text x="80" y="-5" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#FF6B6B" text-anchor="middle">Loss</text>
      <g transform="translate(20, 10)">
        <text x="60" y="15" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#888888" text-anchor="middle">-log(0.03)</text>
        <text x="60" y="40" font-family="CMU Serif, Georgia, serif" font-size="20" fill="#FF6B6B" text-anchor="middle">= 3.51</text>
        <text x="60" y="65" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888" text-anchor="middle">(Bad! High penalty)</text>
      </g>
    </g>
  </g>

  <!-- ============ Loss Curve ============ -->
  <g transform="translate(50, 380)">
    <text x="350" y="0" font-family="CMU Serif, Georgia, serif" font-size="16" fill="#ffffff" text-anchor="middle">The -log curve: Why wrong predictions hurt so much</text>

    <!-- Axes -->
    <g transform="translate(150, 30)">
      <!-- Y axis -->
      <line x1="0" y1="0" x2="0" y2="80" stroke="#444444" stroke-width="1"/>
      <text x="-10" y="5" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#666666" text-anchor="end">Loss</text>
      <text x="-10" y="80" font-family="CMU Serif, Georgia, serif" font-size="9" fill="#666666" text-anchor="end">0</text>

      <!-- X axis -->
      <line x1="0" y1="80" x2="400" y2="80" stroke="#444444" stroke-width="1"/>
      <text x="400" y="95" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#666666" text-anchor="end">P(correct)</text>
      <text x="0" y="95" font-family="CMU Serif, Georgia, serif" font-size="9" fill="#666666" text-anchor="middle">0</text>
      <text x="400" y="95" font-family="CMU Serif, Georgia, serif" font-size="9" fill="#666666" text-anchor="middle">1</text>

      <!-- -log curve (approximation) -->
      <path d="M 10,5 Q 50,20 100,35 T 200,55 T 300,70 T 400,80"
            fill="none" stroke="#FFFF00" stroke-width="2"/>

      <!-- Point annotations -->
      <circle cx="40" cy="15" r="4" fill="#FF6B6B"/>
      <text x="50" y="10" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#FF6B6B">p=0.03 → loss=3.5</text>

      <circle cx="370" cy="78" r="4" fill="#83C167"/>
      <text x="320" y="70" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#83C167">p=0.93 → loss=0.07</text>
    </g>
  </g>
</svg>
