<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500">
  <!-- Pure black background -->
  <rect width="800" height="500" fill="#000000"/>

  <!-- Title -->
  <text x="400" y="35" font-family="CMU Serif, Georgia, serif" font-size="24" fill="#ffffff" text-anchor="middle">JAX vmap: Automatic Vectorization</text>

  <!-- Subtitle -->
  <text x="400" y="58" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#888888" text-anchor="middle">
    Write for one example, run on batches automatically
  </text>

  <!-- ============ Left: Single Example Function ============ -->
  <g transform="translate(50, 90)">
    <text x="130" y="0" font-family="CMU Serif, Georgia, serif" font-size="16" fill="#888888" text-anchor="middle">Write for single example</text>

    <!-- Function box -->
    <rect x="30" y="20" width="200" height="80" fill="#29ABCA" fill-opacity="0.15" stroke="#29ABCA" stroke-width="2" rx="8"/>
    <text x="130" y="50" font-family="monospace" font-size="12" fill="#29ABCA" text-anchor="middle">def f(x):</text>
    <text x="130" y="70" font-family="monospace" font-size="12" fill="#29ABCA" text-anchor="middle">  return x @ W + b</text>

    <!-- Input -->
    <g transform="translate(30, 120)">
      <text x="100" y="15" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888" text-anchor="middle">Input x</text>
      <!-- Single vector -->
      <rect x="50" y="25" width="100" height="25" fill="#FFFF00" fill-opacity="0.2" stroke="#FFFF00" stroke-width="1" rx="3"/>
      <text x="100" y="43" font-family="monospace" font-size="10" fill="#FFFF00" text-anchor="middle">(hidden,)</text>
    </g>

    <!-- Arrow down -->
    <line x1="130" y1="175" x2="130" y2="200" stroke="#666666" stroke-width="2"/>
    <polygon points="130,200 125,193 135,193" fill="#666666"/>

    <!-- Output -->
    <g transform="translate(30, 210)">
      <text x="100" y="15" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888" text-anchor="middle">Output</text>
      <rect x="50" y="25" width="100" height="25" fill="#83C167" fill-opacity="0.2" stroke="#83C167" stroke-width="1" rx="3"/>
      <text x="100" y="43" font-family="monospace" font-size="10" fill="#83C167" text-anchor="middle">(output,)</text>
    </g>
  </g>

  <!-- ============ vmap Arrow ============ -->
  <g transform="translate(310, 180)">
    <rect x="0" y="0" width="140" height="50" fill="#FF6B6B" fill-opacity="0.15" stroke="#FF6B6B" stroke-width="2" rx="8"/>
    <text x="70" y="22" font-family="monospace" font-size="14" fill="#FF6B6B" text-anchor="middle">jax.vmap(f)</text>
    <text x="70" y="40" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#888888" text-anchor="middle">transforms to</text>

    <!-- Arrows -->
    <line x1="-30" y1="25" x2="0" y2="25" stroke="#FF6B6B" stroke-width="2"/>
    <line x1="140" y1="25" x2="170" y2="25" stroke="#FF6B6B" stroke-width="2"/>
    <polygon points="170,25 163,20 163,30" fill="#FF6B6B"/>
  </g>

  <!-- ============ Right: Batched Function ============ -->
  <g transform="translate(490, 90)">
    <text x="130" y="0" font-family="CMU Serif, Georgia, serif" font-size="16" fill="#83C167" text-anchor="middle">Runs on batches!</text>

    <!-- Function box -->
    <rect x="30" y="20" width="200" height="80" fill="#83C167" fill-opacity="0.15" stroke="#83C167" stroke-width="2" rx="8"/>
    <text x="130" y="50" font-family="monospace" font-size="12" fill="#83C167" text-anchor="middle">vmap_f = vmap(f)</text>
    <text x="130" y="70" font-family="monospace" font-size="12" fill="#83C167" text-anchor="middle"># same code, batched!</text>

    <!-- Input - batched -->
    <g transform="translate(30, 120)">
      <text x="100" y="15" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888" text-anchor="middle">Input xs</text>
      <!-- Stacked vectors to show batch -->
      <rect x="45" y="25" width="110" height="50" fill="#FFFF00" fill-opacity="0.2" stroke="#FFFF00" stroke-width="1" rx="3"/>
      <!-- Inner lines to show batch dimension -->
      <line x1="50" y1="37" x2="150" y2="37" stroke="#FFFF00" stroke-width="0.5" stroke-dasharray="3,2"/>
      <line x1="50" y1="50" x2="150" y2="50" stroke="#FFFF00" stroke-width="0.5" stroke-dasharray="3,2"/>
      <line x1="50" y1="63" x2="150" y2="63" stroke="#FFFF00" stroke-width="0.5" stroke-dasharray="3,2"/>
      <text x="100" y="85" font-family="monospace" font-size="10" fill="#FFFF00" text-anchor="middle">(batch, hidden)</text>
    </g>

    <!-- Arrow down -->
    <line x1="130" y1="215" x2="130" y2="240" stroke="#666666" stroke-width="2"/>
    <polygon points="130,240 125,233 135,233" fill="#666666"/>

    <!-- Output - batched -->
    <g transform="translate(30, 250)">
      <text x="100" y="15" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888" text-anchor="middle">Output</text>
      <rect x="45" y="25" width="110" height="50" fill="#83C167" fill-opacity="0.2" stroke="#83C167" stroke-width="1" rx="3"/>
      <line x1="50" y1="37" x2="150" y2="37" stroke="#83C167" stroke-width="0.5" stroke-dasharray="3,2"/>
      <line x1="50" y1="50" x2="150" y2="50" stroke="#83C167" stroke-width="0.5" stroke-dasharray="3,2"/>
      <line x1="50" y1="63" x2="150" y2="63" stroke="#83C167" stroke-width="0.5" stroke-dasharray="3,2"/>
      <text x="100" y="85" font-family="monospace" font-size="10" fill="#83C167" text-anchor="middle">(batch, output)</text>
    </g>
  </g>

  <!-- ============ Bottom: Composability ============ -->
  <g transform="translate(50, 400)">
    <rect x="0" y="0" width="700" height="80" fill="#ffffff" fill-opacity="0.05" stroke="#666666" stroke-width="1" rx="8"/>

    <text x="350" y="25" font-family="CMU Serif, Georgia, serif" font-size="15" fill="#ffffff" text-anchor="middle">Transformations compose!</text>

    <!-- Composition example -->
    <text x="350" y="50" font-family="monospace" font-size="13" fill="#888888" text-anchor="middle">
      jax.jit(jax.vmap(jax.grad(loss_fn)))
    </text>
    <text x="350" y="70" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#888888" text-anchor="middle">
      Compiled batched gradients â€” the JAX superpower
    </text>
  </g>
</svg>
