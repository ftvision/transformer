<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 550">
  <!-- Pure black background -->
  <rect width="800" height="550" fill="#000000"/>

  <!-- Title -->
  <text x="400" y="35" font-family="CMU Serif, Georgia, serif" font-size="24" fill="#ffffff" text-anchor="middle">Kernel Fusion: Why It Matters</text>

  <!-- Subtitle -->
  <text x="400" y="60" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#888888" text-anchor="middle">
    Fusing operations reduces memory traffic — the key bottleneck
  </text>

  <!-- ============ Unfused (left side) ============ -->
  <g transform="translate(50, 100)">
    <text x="150" y="0" font-family="CMU Serif, Georgia, serif" font-size="18" fill="#FF6B6B" text-anchor="middle">Unfused Operations</text>

    <!-- HBM representation -->
    <rect x="0" y="30" width="300" height="50" fill="#29ABCA" fill-opacity="0.15" stroke="#29ABCA" stroke-width="1" rx="5"/>
    <text x="150" y="60" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#29ABCA" text-anchor="middle">HBM (Global Memory)</text>

    <!-- Kernel 1 -->
    <g transform="translate(0, 100)">
      <rect x="50" y="0" width="200" height="40" fill="#FFFF00" fill-opacity="0.15" stroke="#FFFF00" stroke-width="2" rx="5"/>
      <text x="150" y="25" font-family="monospace" font-size="12" fill="#FFFF00" text-anchor="middle">Kernel 1: LayerNorm</text>

      <!-- Arrows for read/write -->
      <line x1="150" y1="-20" x2="150" y2="0" stroke="#29ABCA" stroke-width="2" marker-end="url(#arrowBlue)"/>
      <text x="170" y="-10" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#29ABCA">read x</text>

      <line x1="150" y1="40" x2="150" y2="60" stroke="#FF6B6B" stroke-width="2" marker-end="url(#arrowRed)"/>
      <text x="170" y="55" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#FF6B6B">write y</text>
    </g>

    <!-- Intermediate storage -->
    <rect x="0" y="180" width="300" height="30" fill="#444444" fill-opacity="0.3" stroke="#666666" stroke-width="1" rx="3"/>
    <text x="150" y="200" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#888888" text-anchor="middle">Intermediate in HBM</text>

    <!-- Kernel 2 -->
    <g transform="translate(0, 230)">
      <rect x="50" y="0" width="200" height="40" fill="#FFFF00" fill-opacity="0.15" stroke="#FFFF00" stroke-width="2" rx="5"/>
      <text x="150" y="25" font-family="monospace" font-size="12" fill="#FFFF00" text-anchor="middle">Kernel 2: GELU</text>

      <line x1="150" y1="-20" x2="150" y2="0" stroke="#29ABCA" stroke-width="2"/>
      <text x="170" y="-10" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#29ABCA">read y</text>

      <line x1="150" y1="40" x2="150" y2="60" stroke="#FF6B6B" stroke-width="2"/>
      <text x="170" y="55" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#FF6B6B">write z</text>
    </g>

    <!-- Final HBM -->
    <rect x="0" y="310" width="300" height="50" fill="#29ABCA" fill-opacity="0.15" stroke="#29ABCA" stroke-width="1" rx="5"/>
    <text x="150" y="340" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#29ABCA" text-anchor="middle">HBM (Global Memory)</text>

    <!-- Memory traffic count -->
    <text x="150" y="390" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#FF6B6B" text-anchor="middle">4 memory operations</text>
    <text x="150" y="410" font-family="monospace" font-size="11" fill="#888888" text-anchor="middle">read x, write y, read y, write z</text>
  </g>

  <!-- ============ Arrow between ============ -->
  <g transform="translate(380, 280)">
    <line x1="0" y1="0" x2="40" y2="0" stroke="#83C167" stroke-width="3"/>
    <polygon points="40,0 32,-5 32,5" fill="#83C167"/>
    <text x="20" y="-15" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#83C167" text-anchor="middle">Fuse!</text>
  </g>

  <!-- ============ Fused (right side) ============ -->
  <g transform="translate(450, 100)">
    <text x="150" y="0" font-family="CMU Serif, Georgia, serif" font-size="18" fill="#83C167" text-anchor="middle">Fused Kernel</text>

    <!-- HBM representation -->
    <rect x="0" y="30" width="300" height="50" fill="#29ABCA" fill-opacity="0.15" stroke="#29ABCA" stroke-width="1" rx="5"/>
    <text x="150" y="60" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#29ABCA" text-anchor="middle">HBM (Global Memory)</text>

    <!-- Single Fused Kernel -->
    <g transform="translate(0, 130)">
      <rect x="30" y="0" width="240" height="120" fill="#83C167" fill-opacity="0.15" stroke="#83C167" stroke-width="2" rx="5"/>
      <text x="150" y="30" font-family="monospace" font-size="12" fill="#83C167" text-anchor="middle">Fused Kernel:</text>
      <text x="150" y="50" font-family="monospace" font-size="12" fill="#83C167" text-anchor="middle">LayerNorm + GELU</text>

      <!-- Internal operations -->
      <text x="150" y="80" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#888888" text-anchor="middle">Intermediate stays in</text>
      <text x="150" y="95" font-family="CMU Serif, Georgia, serif" font-size="11" fill="#FFFF00" text-anchor="middle">registers/SRAM</text>

      <!-- Single read arrow -->
      <line x1="150" y1="-50" x2="150" y2="0" stroke="#29ABCA" stroke-width="2"/>
      <text x="170" y="-35" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#29ABCA">read x</text>

      <!-- Single write arrow -->
      <line x1="150" y1="120" x2="150" y2="170" stroke="#FF6B6B" stroke-width="2"/>
      <text x="170" y="150" font-family="CMU Serif, Georgia, serif" font-size="10" fill="#FF6B6B">write z</text>
    </g>

    <!-- Final HBM -->
    <rect x="0" y="310" width="300" height="50" fill="#29ABCA" fill-opacity="0.15" stroke="#29ABCA" stroke-width="1" rx="5"/>
    <text x="150" y="340" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#29ABCA" text-anchor="middle">HBM (Global Memory)</text>

    <!-- Memory traffic count -->
    <text x="150" y="390" font-family="CMU Serif, Georgia, serif" font-size="14" fill="#83C167" text-anchor="middle">2 memory operations</text>
    <text x="150" y="410" font-family="monospace" font-size="11" fill="#888888" text-anchor="middle">read x, write z</text>
  </g>

  <!-- ============ Key Insight Box ============ -->
  <g transform="translate(100, 470)">
    <rect x="0" y="0" width="600" height="60" fill="#ffffff" fill-opacity="0.05" stroke="#666666" stroke-width="1" rx="5"/>
    <text x="300" y="25" font-family="CMU Serif, Georgia, serif" font-size="16" fill="#ffffff" text-anchor="middle">2× less memory traffic = potentially 2× faster</text>
    <text x="300" y="45" font-family="CMU Serif, Georgia, serif" font-size="12" fill="#888888" text-anchor="middle">Memory-bound ops (LayerNorm, GELU, Softmax) benefit most from fusion</text>
  </g>

  <!-- Arrow markers -->
  <defs>
    <marker id="arrowBlue" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#29ABCA"/>
    </marker>
    <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#FF6B6B"/>
    </marker>
  </defs>
</svg>
